<!doctype html><html lang=zh><head><meta charset=UTF-8><meta content="default-src 'self';font-src 'self' data:;img-src 'self' https://* data:;media-src 'self';style-src 'self';frame-src player.vimeo.com https://www.youtube-nocookie.com;connect-src 'self';script-src 'self' 'self'" http-equiv=Content-Security-Policy><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://reichtumqian.pages.dev name=base><title>
Reichtum's Blog • 论文阅读：Control Theoretic Approach to Fine-Tuning and Transfer Learning</title><link title="Reichtum's Blog - Atom Feed" href=https://reichtumqian.pages.dev/atom.xml rel=alternate type=application/atom+xml><link href="https://reichtumqian.pages.dev/custom_subset.css?h=0b9535a28bc3d5bf2321" rel=stylesheet><link href="https://reichtumqian.pages.dev/main.css?h=28b3fcbb58f2f22a8c44" rel=stylesheet><meta content="light dark" name=color-scheme><meta content="Reichtum's Blog" name=description><meta content="Reichtum's Blog" property=og:description><meta content="论文阅读：Control Theoretic Approach to Fine-Tuning and Transfer Learning" property=og:title><meta content=article property=og:type><meta content=en_GB property=og:locale><meta content=https://reichtumqian.pages.dev/blog/lun-wen-yue-du-control-theoretic-approach-to-fine-tuning-and-transfer-learning/ property=og:url><meta content="Reichtum's Blog" property=og:site_name><noscript><link href=https://reichtumqian.pages.dev/no_js.css rel=stylesheet></noscript><script src=https://reichtumqian.pages.dev/js/initializeTheme.min.js></script><script defer src=https://reichtumqian.pages.dev/js/themeSwitcher.min.js></script><script src="https://reichtumqian.pages.dev/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><script defer src=https://reichtumqian.pages.dev/js/lunr/lunrStemmerSupport.min.js></script><script defer src=https://reichtumqian.pages.dev/js/lunr/lunr.zh.min.js></script><body><header><nav class=navbar><div class=nav-title><a class=home-title href=https://reichtumqian.pages.dev/>Reichtum's Blog</a></div><div class=nav-navs><ul><li><a class="nav-links no-hover-padding" href=https://reichtumqian.pages.dev/blog/>blog </a><li><a class="nav-links no-hover-padding" href=https://reichtumqian.pages.dev/archive/>archive </a><li><a class="nav-links no-hover-padding" href=https://reichtumqian.pages.dev/tags/>tags </a><li><a class="nav-links no-hover-padding" href=https://reichtumqian.pages.dev/projects/>projects </a><li class=menu-icons-container><ul class=menu-icons-group><li class="js menu-icon"><div aria-label="Press $SHORTCUT to open search" class="search-icon interactive-icon" title="Press $SHORTCUT to open search" id=search-button role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><li class="theme-switcher-wrapper js"><div aria-label="Toggle dark mode" title="Toggle dark/light mode" aria-pressed=false class=theme-switcher role=button tabindex=0></div><div aria-label="Reset mode to default" class="theme-resetter arrow" title="Reset mode to default" aria-hidden=true role=button tabindex=0></div></ul></ul></div></nav></header><div class=content><main><article class=h-entry><h1 class="p-name article-title">论文阅读：Control Theoretic Approach to Fine-Tuning and Transfer Learning</h1><a class="u-url u-uid" href=https://reichtumqian.pages.dev/blog/lun-wen-yue-du-control-theoretic-approach-to-fine-tuning-and-transfer-learning/></a><ul class=meta><span class="hidden p-author h-card"> <a class=u-url href=https://reichtumqian.pages.dev rel=author title=Reichtum>Reichtum</a> </span><li><time class=dt-published datetime=2025-09-24>24th Sep 2025</time><li title="2649 words"><span aria-hidden=true class=separator>•</span>14 min read<li class=tag><span aria-hidden=true class=separator>•</span>Tags: <li class=tag><a class=p-category href=https://reichtumqian.pages.dev/tags/fine-tuning/>Fine Tuning</a>, <li class=tag><a class=p-category href=https://reichtumqian.pages.dev/tags/catastrophic-forgetting/>Catastrophic Forgetting</a></ul><section class="e-content body"><blockquote><p>Original Paper: <a href=https://arxiv.org/abs/2404.11013>[2404.11013] Control Theoretic Approach to Fine-Tuning and Transfer Learning</a></blockquote><hr><h2 id=preliminaries>Preliminaries</h2><p><strong>Hausdorff Space</strong>: A topological space $(X, \mathcal{T})$ is said to be a <em>Hausdorff space</em> if<p>$$ \forall x,y\in X,x\neq y\Longrightarrow\exists U,V\in\mathcal{T}\mathrm{<del>s.t.</del>}x\in U,y\in V,\mathrm{<del>and</del>}U\cap V=\emptyset $$<p>where $\mathcal{T}$ is the set of all the open sets in the space.<blockquote><p>Hausdorff 空间保证了点的可分离性。</blockquote><p><strong>Basis of Topological Spaces</strong>: The <em>basis</em> of a topological space $\mathcal{B}$ is a set of open sets satisfying<p>$$ \exists\mathcal{B}=\{B_1,B_2,B_3,\ldots\}\subseteq\mathcal{T}\mathrm{<del>s.t.</del>}\forall U\in\mathcal{T},U=\bigcup_{i\in I}B_i\text{ for some }I $$<p><strong>Second-Countable</strong>: A topological space $(X, \mathcal{T})$ is said to be <em>second countable</em> if $\mathcal{T}$ has a countable basis.<p><strong>Homeomorphism</strong>: A mapping $\phi: U \to V$ is <em>homeomorphism</em> if both $\phi$ and $\phi^{-1}$ are continuous mapping.<p><strong>Locally Euclidean and Chart</strong>: A topological space $X$ is said to be <em>locally Euclidean</em> if for any $p \in X$, there exists an open neighbor $U$ of $p$, a open set $V \subseteq \mathbb{R}^n$, and a homeomorphism $\phi$ such that<p>$$ \phi: U \to V. $$<p>Here $\phi$ is called the <em>chart</em>.<blockquote><p>流形上每个局部都可以被坐标卡 chart 映射到一块 $\mathbb{R}^n$ 的区域</blockquote><p><strong>Topological Manifold</strong>: An $n$-dimensional <em>topological manifold</em> is a topological space that is Hausdorff, second-countable, and locally Euclidean of dimension $n$.<p><strong>Smooth Curve</strong>: A <em>smooth curve</em> at a point $p$ on an manifold $M$ is a smooth map $\gamma: I \to M$, where $I \subseteq \mathbb{R}$ is an open interval containing $0$, such that $\gamma(0) = p$.<p><strong>Equivalence Relation on Curves</strong>: Let $(U, \phi)$ be a local chart containing the point $p$, where $\phi: U \to \mathbb{R}^n$. Two smooth curves $\gamma_1$ and $\gamma_2$ at $p$ are said to be <em>equivalent</em> iff their velocity vectors in the chart coordinates are identical, that is<p>$$ \frac{\mathrm{d}}{\mathrm{d}t}(\phi\circ\gamma_1)(t)\bigg|_{t=0}=\frac{\mathrm{d}}{\mathrm{d}t}(\phi\circ\gamma_2)(t)\bigg|_{t=0}. $$<blockquote><p>可以理解为切平面上一个方向的曲线是等价的</blockquote><p><strong>Tangent Vector</strong>: A <em>tangent vector</em> $v$ at a point $p$ is an equivalence class of all smooth curves passing through $p$. We denote this as $v = [\gamma]$.<p><strong>Tangent Space</strong>: The tangent space at a point $p$ on $M$, denoted by $T_pM$, is the set of all tangent vectors at $p$:<p>$$ T_pM:=\{[\gamma]\mid\gamma:I\to M\text{ is a smooth curve with }\gamma(0)=p\} $$<hr><h2 id=problem-statement>Problem Statement</h2><p><strong>Dataset and System</strong>: Consider the paired sets $(\mathcal{X},\mathcal{Y})=\{(x^{i},y^{i})\}_{i=1}^{q}$ in a connected Riemannian manifold $\mathcal{M}$​, where elements of $\mathcal{X}$ are pairwise distinct. We take the system<p>$$ \dot{x}(t)=f(u(t), x(t)), \quad u\in L_\infty([0,T],\mathbb{R}^{\bar{n}\times\bar{n}}) $$<p>$$ x^i\in\mathbb{R}^n \overset{E}{\operatorname*{\longrightarrow}} \bar{x}^i\in\mathbb{R}^{\bar{n}} \overset{\varphi_T(u,\cdot)}{\operatorname*{\longrightarrow}} \bar{y}^i\in\mathbb{R}^{\bar{n}} \overset{R}{\operatorname*{\longrightarrow}} y^i\in\mathbb{R}^{n_o} $$<p>where $E: \mathbb{R}^n \to \mathbb{R}^{\bar{n}}$ is an embedding function, $R: \mathbb{R}^{\bar{n}} \to \mathbb{R}^n$ is a readout function, $\bar{n}$ is the embedding dimension, $n_o$ is the output dimension, and $\varphi_t(u,\cdot)$ is the map generated by the control function $u$. For simplicity, we assume that $n = \bar{n}$, and let $R$ be the orthogonal projection, that is<p>$$ R:x\in\mathbb{R}^n\mapsto Cx\in\mathbb{R}^{n_o}, \quad \text{where} \quad C=[O_{n_{o}\times n-n_{o}}I_{n_{o}\times n_{o}}]\in\mathbb{R}^{n_{o}\times n}. $$<blockquote><p>If $n = n_o$ and $R$ is the identity map, then we call the problem the control <u>with fixed end-points</u>（固定终值条件）. Otherwise, control with <u>partially constrained end-points</u>（终值约束条件）.</blockquote><p><strong>Objective (Memorization Property)</strong> : The control $u$ is said to have memorized the ensemble $(\mathcal{X}, \mathcal{Y})$ if the following holds for a finite $T \geq 0$:<p>$$ R(\varphi_T(u,E(x^i)))=y^i, \quad \forall x^i\in\mathcal{X}. $$<blockquote><p>我们的总目标就是找到一个控制信号 $u$，对任意数据都能满足 memorization property。</blockquote><p><strong>Cost Functional</strong>: We define per-sample cost functional for a given point $x^i$ as<p>$$ \mathcal{J}^i(u)=\frac{1}{2}\|C\varphi(u,x^i)-y^i\|^2. $$<p>Then, the cost-functional for the entire ensemble is<p>$$ \mathcal{J}(u,\mathcal{X}):=\sum_{i=1}^{q}\|C\varphi(u,x^{i})-y^{i}\|^{2}+\lambda\int_{0}^{T}\|u(\tau)\|^{2}d\tau. $$<p>where $\lambda$ is some regularization coefficient.<p><strong>q-Folded Method</strong>: Suppose $\mathcal{X}$ contains $q$ data points. Stack all the points in $\mathcal{X}$ into a vector of dimension $nq$ denoted by $X_0$, and the stacked outputs by $Y$. The minimization problem is<p>$$ \mathcal{J}(u,X_0):=\|\Lambda(C)\vec{\varphi}_T(u,X_0)-Y\|^2+\int_0^T\|u(\tau)\|^2d\tau. $$<p>$$ \text{subject to} \quad \dot{X}(t)=F(u(t),X(t)), \quad X(0)=X_0. $$<p>where $\Lambda(C):=\mathrm{diag}(C,\cdots,C)\in\mathbb{R}^{n_{0}q\times nq}$, and $F$ is the dynamics created by copying $f$ $q$-times.<blockquote><p>使用 q-folded method 求解非常困难。</blockquote><hr><h2 id=existence-of-a-control-function>Existence of a Control Function</h2><p><strong>Lie Bracket</strong>: Let $g_1$ and $g_2$ be differentiable vector fields in $\mathcal{M} \subset \mathbb{R}^n$, we call the <em>Lie bracket</em> of $g_1$ and $g_2$ the vector field:<p>$$ <a href=https://reichtumqian.pages.dev/blog/lun-wen-yue-du-control-theoretic-approach-to-fine-tuning-and-transfer-learning/x>g_1,g_2</a>:=\frac{\partial g_2(x)}{\partial x}g_1(x)-\frac{\partial g_1(x)}{\partial x}g_2(x), \quad \mathrm{for} \quad x\in\mathcal{M} $$<blockquote><p>Lie bracket 的核心含义：测量路径的不闭合程度，沿着以下两种路径：(1) 先 $g_1$ 走 $\epsilon$，再 $g_2$ 走 $\epsilon$；(2) $g_2$ 走 $\epsilon$，再 $g_1$ 走 $\epsilon$。两种路线到达的终点距离为：<p>$$ \epsilon^2\left(\frac{\partial g_2(x)}{\partial x}g_1(x)-\frac{\partial g_1(x)}{\partial x}g_2(x)\right). $$</blockquote><p><strong>Maneuver Set</strong>: Let $\mathcal{F}^0=\{f(x,u)|u\in L_\infty([0,T],\mathbb{R}^{n\times n})\}$ be the maneuver set with all the feasible control functions, and recursively define<p>$$ \mathcal{F}^k=\mathcal{F}^{k-1}\cup\left\{<a href=https://reichtumqian.pages.dev/blog/lun-wen-yue-du-control-theoretic-approach-to-fine-tuning-and-transfer-learning/x>g_i,g_j</a>\mid g_i,g_j\in\mathcal{F}^{k-1}\right\}. $$<blockquote><p>$\mathcal{F}$ 是中的元素是关于 $x$ 的函数<ul><li>$\mathcal{F}^0$：$u$ 可以是任意矩阵，此时每个 $u$ 对应一种运动模式 $g_i(x)$，因此 $\mathcal{F}^0$ 包含了所有的<u>直接运动方式</u>（但是不能组合不同运动模式）。<li>$\mathcal{F}^k$：在 $\mathcal{F}^{k-1}$ 的运动模式基础上进一步进行组合（例如快速交替执行它们），如果这种组合产生了一种新的运动模式，则加入动作库。</ul><p>这种方式一般适用于 $f$ 是<strong>非线性</strong>的情况，否则直接组合 $u$ 即可。</blockquote><p><strong>Control Distribution</strong>: The corresponding distributions at point $x \in \mathbb{R}^n$ are<p>$$ \mathcal{D}_{x}^{k}(\mathcal{F})=\mathrm{span}\left\{g(x)\mid g\in\mathcal{F}^{k}\right\}. $$<p>We can see that $\mathcal{D}_{x}^{k}(\mathcal{F})$ satisfies $\mathcal{D}_{x}^{k}(\mathcal{F})\subseteq\mathcal{D}_{x}^{k+1}(\mathcal{F})$.<blockquote><p>$\mathcal{D}_{x}^{k}(\mathcal{F})$ 表示从 $x$ 出发，从 $\mathcal{F}^k$ 动作库中取一个动作，能达到的集合。</blockquote><p><strong>Bracket-Generating</strong>: We call $\mathcal{F}$ <em>bracket-generating</em> if $\mathcal{D}_x^\infty (\mathcal{F})$ spans $T_xE(\mathcal{M})$ for all $x \in E(\mathcal{M})$. Here $E$ is the embedding function and $T_x$ represents the tangent space.<blockquote><p>$T_xE(\mathcal{M})$ 表示了所有可能的运动方向，因此 bracket-generating 表示了我们的控制可以控制往任何方向。</blockquote><p><strong>q-Folded Statement</strong>: Assume $\mathcal{X}$ contains finite pairwise distinct points, $n > n_o$, $R(x) = Cx$. If $\tilde{\mathcal{F}}$ is bracket-generating in $E(\mathcal{M})^{(q)}$, then there exists $u$ and a finite time $T \geq 0$ such that the system memorizes $(\mathcal{X}, \mathcal{Y})$ by the control function $u$.<ul><li>Embedding space $E(\mathcal{M})^{q}:=E(\mathcal{M})\times\cdots\times E(\mathcal{M})$<li>Ensemble $X=\left[E(x^1)^\top,\cdots,E(x^q)^\top\right]^\top\in E(\mathcal{M})^q \subseteq \mathbb{R}^{nq}$<li>$\Delta^{q}:=\{[E(x^{1})^{\top},\cdots,E(x^{q})^{\top}]^{\top}\in E(\mathcal{M})^{q} | E(x^i)=E(x^j)\mathrm{<del>for</del>}i\neq j\}$<li>Complement $E(\mathcal{M})^{(q)}:=E(\mathcal{M})^{q}\setminus\Delta^{q}$<li>$\tilde{\mathcal{F}}^0=\{[f(u,x^1)^\top,f(u,x^2)^\top,\cdots,f(u,x^q)^\top]^\top\in\mathbb{R}^{nq}|u\in L_\infty([0,T],\mathbb{R}^{n\times n})\}.$</ul><hr><h2 id=tuning-without-forgetting>Tuning without Forgetting</h2><p><strong>Objective</strong>: Let $\mathcal{X}^{j}=\{x^{i}\in\mathcal{X}|i=1,2,\cdots,j\}$, and $\mathcal{Y}^j$ the corresponding batch of labels. Denote $u^k$ the control function at the $k$th iteration. Assume that $u^k$ has memorized the ensemble $(\mathcal{X}^{j},\mathcal{Y}^{j})$. We propose an iterative method to find a control $u^\ast$ such that<p>$$ C\varphi(u^*,x^i)=y^i \quad \text{for all} \quad x^i\in\mathcal{X}^{j+1}(=\mathcal{X}^j\cup\{x^{j+1}\}) $$<p><strong>Tuning without Forgetting</strong>: Assume that $u^k$ has memorized the ensemble $(\mathcal{X}^{j},\mathcal{Y}^{j})$. If the update $\delta u^k$ satisfies<p>$$ \mathcal{J}^{j+1}(u^k+\delta u^k)\leq\mathcal{J}^{j+1}(u^k) $$<p>$$ R\left(\varphi(u^k+\delta u^k,x^i)\right)=y^i+o(\delta u^k),\quad \forall x^i\in\mathcal{X}^j $$<p>Then the control function $u^{k+1} := u^k + \delta u^k$ has been <em>tuned for</em> <em>$\mathcal{X}^{j+1}$</em> <em>without forgetting</em> $\mathcal{X}^j$.<blockquote><p>条件1：要求更新控制后，对新数据点的 cost 下降<p>条件2：要求更新控制后，对老数据点的影响不明显</blockquote><hr><h2 id=a-projected-gradient-descent-method>A Projected Gradient Descent Method</h2><p><strong>Linearized Controllability Property</strong>: We say the system $\dot{x}(t)=f(x(t),u(t))$ has the <em>Linearized Controllability Property (LPC)</em> at $x^i$ for all $u\in L_{\infty}([0,T],\mathbb{R}^{n\times n})$ if the linear time varying system<p>$$ \dot{z}(t)=\left(\frac{\partial f(x,u)}{\partial x}\bigg|_{(x=\varphi_t(u,x^i),u)}\right)z(t)+\left(\frac{\partial f(x,u)}{\partial u}\bigg|_{(x=\varphi_t(u,x^i),u)}\right)v(t), $$<p>where $v(t)\in L_\infty([0,T],\mathbb{R}^{n\times n})$ is controllable.<blockquote><p>LPC 是算法能正常运作的前提，其保证了非线性系统 $\dot{x} = f(x,u)$ 在局部线性化后，扰动可以被任意控制。</blockquote><p><strong>Impact of Updated Control</strong>: Suppose that a given control function $u$ has memorized the pair of points $(x^i, y^i)$, then<p>$$ \delta\varphi_t(u,x^i)=\int_0^t\Phi_{(u,x^i)}(t,\tau)\frac{\partial f(x,u)}{\partial u}\bigg|_{(x=\varphi_\tau(u,x^i),u)}\delta u(\tau)d\tau $$<p>up to first order in $\delta u(t)$. Here $\Phi_{(u,x^i)}(t, \tau)$ is the state transfer matrix defined by<p>$$ \frac{\mathrm{d}}{\mathrm{d}t}\Phi(t,\tau)=A(t)\Phi(t,\tau), \quad \Phi(\tau,\tau)=I $$<p>$$ A(t) = \frac{\partial f(x,u)}{\partial x}\bigg|_{(x=\varphi_t(u,x^i),u)} $$<blockquote><p>上面的公式给出了如果我在各个 $\tau$ 时刻更新了控制为 $\delta u(\tau)$，那么最终的输出会变多少。</blockquote><p><strong>L Operator</strong>: Let $R$ be the readout function,<p>$$ \mathcal{L}_{(u,x^i)}(\delta u):=R\left(\int_0^T\Phi_{(u,x^i)}(T,\tau)\frac{\partial f(x(\tau),u(\tau))}{\partial u}\delta u(\tau)d\tau\right) $$<blockquote><p>$\mathcal{L}$ 算子代表了 $\delta u$ 对最终输出的影响，如果希望不遗忘，则尽可能要让 $\mathcal{L}$ 算子为 $0$。</blockquote><p><strong>Null Space of L Operator</strong>:<p>$$ \mathcal{K}(u,x^i):=\operatorname{span}\{\delta u\in L_\infty([0,T],\mathbb{R}^{n\times n})\mid\mathcal{L}_{(u,x^i)}(\delta u)=0\} $$<p>$$ \mathcal{K}(u,\mathcal{X}^j):=\mathrm{span}\{\delta u\in L_\infty([0,T],\mathbb{R}^{n\times n})\mid\delta u\in\bigcap_{x^i\in\mathcal{X}^j}\mathcal{K}(u,x^i)\} $$<blockquote><p>$\mathcal{K}$ 的价值在于只要我们选出了一个安全的子空间用于更新/投影</blockquote><p><strong>Projection Operator</strong>:<p>$$ \operatorname{proj}_{\mathcal{K}(u,\mathcal{X}^j)}\nabla_{u(t)}\mathcal{J}^{j+1}(u):=\arg\min_{d(t)\in\mathcal{K}(u,\mathcal{X}^j)}\int_{0}^{T}\|d(\tau)-\nabla_{u(\tau)}\mathcal{J}^{j+1}(u)\|^2d\tau $$<blockquote><p>将理想学习方向 $\nabla_{u(t)}\mathcal{J}^{j+1}$ 投影到 $\mathcal{K}(u,\mathcal{X}^j)$ 中，从而构成更新方向，即 $\delta u=\mathrm{proj}_{\mathcal{K}}(\nabla_uJ^{j+1})$。这里的投影操作就是找了 $\mathcal{K}(u,\mathcal{X}^j)$ 中离 $\nabla_{u(t)}\mathcal{J}^{j+1}$ 距离最近的。</blockquote><hr><h2 id=main-results>Main Results</h2><p><strong>Condition for Tuning without Forgetting</strong>:<p><img alt=image src=https://reichtumqian.pages.dev/blog/lun-wen-yue-du-control-theoretic-approach-to-fine-tuning-and-transfer-learning/assets/image-20250923162925-4ajpvcw.png>​<p><strong>More Detailed Condition</strong>:<p><img alt=image src=https://reichtumqian.pages.dev/blog/lun-wen-yue-du-control-theoretic-approach-to-fine-tuning-and-transfer-learning/assets/image-20250923163040-l7cwbjx.png>​<hr><h2 id=numerical-methods>Numerical Methods</h2><p><strong>Approximation of</strong> $\mathcal{L}_{(u,x^i)}(\cdot)$: We provide a method to compute a numerical approximation of $\mathcal{L}_{(u,x^i)}(\cdot)$ for all $x^i \in \mathcal{X}^j$,<p><img alt=image src=https://reichtumqian.pages.dev/blog/lun-wen-yue-du-control-theoretic-approach-to-fine-tuning-and-transfer-learning/assets/image-20250923171129-hc0u9w1.png>​<p><strong>Phase 1 (Implement Theorem 1)</strong> :<p><img alt=image src=https://reichtumqian.pages.dev/blog/lun-wen-yue-du-control-theoretic-approach-to-fine-tuning-and-transfer-learning/assets/image-20250923171225-axwn57g.png>​<p><strong>Phase 2 (Minimize the Norm of</strong> **$u$**​ <strong>)</strong> : In this phase, we project the gradient of the $L^2$ norm of the control function onto the subspace of functions $\mathcal{K}(u^k, \mathcal{X})$ at each iteration.<p><img alt=image src=https://reichtumqian.pages.dev/blog/lun-wen-yue-du-control-theoretic-approach-to-fine-tuning-and-transfer-learning/assets/image-20250923171302-jj3w9kz.png>​<p><strong>Phase 3 (Refinement)</strong> : In this phase, we aim to refine the control $u$ to steer all the points closer to their associated end-points. Let $\mathcal{P}$ be the number of iterations per sample.<p><img alt=image src=https://reichtumqian.pages.dev/blog/lun-wen-yue-du-control-theoretic-approach-to-fine-tuning-and-transfer-learning/assets/image-20250923171331-5b7vmk1.png>​<p>‍</section></article></main><div id=button-container><div id=toc-floating-container><input class=toggle id=toc-toggle type=checkbox><label class=overlay for=toc-toggle></label><label title="Toggle Table of Contents" class=button for=toc-toggle id=toc-button><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M414.82-193.094q-18.044 0-30.497-12.32-12.453-12.319-12.453-30.036t12.453-30.086q12.453-12.37 30.497-12.37h392.767q17.237 0 29.927 12.487 12.69 12.486 12.69 30.203 0 17.716-12.69 29.919t-29.927 12.203H414.82Zm0-244.833q-18.044 0-30.497-12.487Q371.87-462.9 371.87-480.45t12.453-29.92q12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.511 12.69 12.512 12.69 29.845 0 17.716-12.69 30.086-12.69 12.37-29.927 12.37H414.82Zm0-245.167q-18.044 0-30.497-12.32t-12.453-30.037q0-17.716 12.453-30.086 12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.486 12.69 12.487 12.69 30.203 0 17.717-12.69 29.92-12.69 12.203-29.927 12.203H414.82ZM189.379-156.681q-32.652 0-55.878-22.829t-23.226-55.731q0-32.549 23.15-55.647 23.151-23.097 55.95-23.097 32.799 0 55.313 23.484 22.515 23.484 22.515 56.246 0 32.212-22.861 54.893-22.861 22.681-54.963 22.681Zm0-245.167q-32.652 0-55.878-23.134-23.226-23.135-23.226-55.623 0-32.487 23.467-55.517t56.12-23.03q32.102 0 54.721 23.288 22.62 23.288 22.62 55.775 0 32.488-22.861 55.364-22.861 22.877-54.963 22.877Zm-.82-244.833q-32.224 0-55.254-23.288-23.03-23.289-23.03-55.623 0-32.333 23.271-55.364 23.272-23.03 55.495-23.03 32.224 0 55.193 23.288 22.969 23.289 22.969 55.622 0 32.334-23.21 55.364-23.21 23.031-55.434 23.031Z"/></svg></label><div class=toc-content><div class=toc-container><ul><li><a href=https://reichtumqian.pages.dev/blog/lun-wen-yue-du-control-theoretic-approach-to-fine-tuning-and-transfer-learning/#preliminaries>Preliminaries</a><li><a href=https://reichtumqian.pages.dev/blog/lun-wen-yue-du-control-theoretic-approach-to-fine-tuning-and-transfer-learning/#problem-statement>Problem Statement</a><li><a href=https://reichtumqian.pages.dev/blog/lun-wen-yue-du-control-theoretic-approach-to-fine-tuning-and-transfer-learning/#existence-of-a-control-function>Existence of a Control Function</a><li><a href=https://reichtumqian.pages.dev/blog/lun-wen-yue-du-control-theoretic-approach-to-fine-tuning-and-transfer-learning/#tuning-without-forgetting>Tuning without Forgetting</a><li><a href=https://reichtumqian.pages.dev/blog/lun-wen-yue-du-control-theoretic-approach-to-fine-tuning-and-transfer-learning/#a-projected-gradient-descent-method>A Projected Gradient Descent Method</a><li><a href=https://reichtumqian.pages.dev/blog/lun-wen-yue-du-control-theoretic-approach-to-fine-tuning-and-transfer-learning/#main-results>Main Results</a><li><a href=https://reichtumqian.pages.dev/blog/lun-wen-yue-du-control-theoretic-approach-to-fine-tuning-and-transfer-learning/#numerical-methods>Numerical Methods</a></ul></div></div></div><a title="Go to the top of the page" class=no-hover-padding href=# id=top-button> <svg viewbox="0 0 20 20" fill=currentColor><path d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z"/></svg> </a></div><link href=https://reichtumqian.pages.dev/katex.min.css rel=stylesheet><script defer src=https://reichtumqian.pages.dev/js/katex.min.js></script><span class=hidden id=copy-success> Copied! </span><span class=hidden id=copy-init> Copy code to clipboard </span><script defer src=https://reichtumqian.pages.dev/js/copyCodeToClipboard.min.js></script></div><footer><section><nav class="socials nav-navs"><ul><li><a class="nav-links no-hover-padding social" href=https://reichtumqian.pages.dev/atom.xml> <img alt=feed loading=lazy src=https://reichtumqian.pages.dev/social_icons/rss.svg title=feed> </a></ul></nav><nav class=nav-navs></nav><div class=credits><small> Powered by <a href=https://www.getzola.org>Zola</a> & <a href=https://github.com/welpo/tabi>tabi</a> </small></div></section><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><h1 class=visually-hidden id=modalTitle>Search</h1><div id=modal-content><div id=searchBar><div aria-hidden=true class=search-icon><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search… role=combobox spellcheck=false><div class="close-icon interactive-icon" title="Clear search" id=clear-search role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></div></div><div id=results-container><div id=results-info><span id=zero_results> No results</span><span id=one_results> 1 result</span><span id=many_results> $NUMBER results</span><span id=two_results> $NUMBER results</span><span id=few_results> $NUMBER results</span></div><div id=results role=listbox></div></div></div></div></footer>